---
title: "ì½”í‹€ë¦°ì˜ Scope FunctionëŠ” ì–¸ì œì“¸ê¹Œ"
date: 2022-04-20
update: 2022-04-20
tags:
  - Kotlin
  - Scope Function
series: "Kotlin"
---
# Scope Function
ì½”í‹€ë¦°ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ __"í‘œì¤€ ìŠ¤ì½”í”„ í•¨ìˆ˜"__ ë¼ëŠ”ê²ƒì„ ì œê³µí•œë‹¤.   
ìŠ¤ì½”í”„ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ì˜ ë³µì¡í•œ ì½”ë“œë¥¼ ë‹¨ìˆœí™”í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

ìŠ¤ì½”í”„ í•¨ìˆ˜ë¥¼ __ëŒë‹¤ì‹ìœ¼ë¡œ ì‚¬ìš©ì„ í•˜ê²Œë˜ë©´ ì¼ì‹œì ì¸ Scope(ë²”ìœ„)ê°€ í˜•ì„±__ ë˜ê³ , ì´ ë²”ìœ„ ì•ˆì—ì„œëŠ” __ê°ì²´ì— ëŒ€í•´ì„œ ì¼ì¼ì´ ì°¸ì¡°í•˜ì§€ ì•Šê³  ê°ì²´ì— ëŒ€í•œ ì ‘ê·¼__ ì„ í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì½”í‹€ë¦°ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤ì½”í”„ í•¨ìˆ˜ë“¤ì€ `let`, `also`, `with`, `run`, `apply`ë¡œ 5ê°€ì§€ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.   
ê° í‚¤ì›Œë“œì— ëŒ€í•´ì„œ ë‹¨ì–´ì˜ ì˜ë¯¸ë¥¼ ë³´ë©´ ì–´ë ´í’‹ì´ ì–´ë– í•œ ê¸°ëŠ¥ì„ í•  ê²ƒì´ë‹¤ë¼ëŠ” ê°ì€ ì˜¤ì§€ë§Œ __ì—­í• ì´ë‚˜ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥ë“¤ì´ ë¹„ìŠ·í•˜ì—¬__ ì–´ë–¤ ìƒí™©ì— ì•Œë§ì€ ìŠ¤ì½”í”„ í•¨ìˆ˜ë¥¼ ì¨ì•¼í•˜ëŠ”ì§€ __í—·ê°ˆë¦¬ê²Œ ëœë‹¤.__(ì§€ê¸ˆìƒíƒœ..ğŸ˜¨)

ìµœê·¼ì— ì•ˆë“œë¡œì´ë“œ í”„ë¡œì íŠ¸ì—ì„œ ìŠ¤ì½”í”„ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ë§Œ ëª…í™•í•œ ì°¨ì´ì ì„ ì•Œì§€ëª»í•˜ê³  ì œëŒ€ë¡œ ì‚¬ìš©í•˜ê³  ìˆë‚˜? ë¼ëŠ” ì˜ë¬¸ì´ ìƒê²¨ ì´ë²ˆ í¬ìŠ¤íŒ…ì„ í†µí•˜ì—¬ ê°ê°ì˜ ì°¨ì´ì , íŠ¹ì§•ë“¤ì„ ì •ë¦¬í•˜ë ¤ê³  í•œë‹¤.

## let
> fun <T, R> T.let(block: (T) -> R): R

`let` í•¨ìˆ˜ëŠ” ì œë„¤ë¦­ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜í™”ëœ íƒ€ì… Tì˜ í™•ì¥ í•¨ìˆ˜ì´ë‹¤. ë”°ë¼ì„œ __ìê¸°ìì‹ ì„ ì¸ìˆ˜ë¡œ ì „ë‹¬í•˜ê³  ìˆ˜í–‰ëœ ê²°ê³¼(ë¸”ë¡ì˜ ë§ˆì§€ë§‰ ê°’)ë¥¼ ë°˜í™˜__ í•˜ë©°, ì¸ìˆ˜ë¡œ ì „ë‹¬í•œ ê°ì²´ì˜ ì°¸ì¡°ëŠ” __it__ ìœ¼ë¡œ ì°¸ì¡°ë¥¼ í•œë‹¤.

```kotlin
data class Person(var name: String, var favorite: String)

fun main() {
    val person1 = Person("í˜í¼", "Dr pepper")
    person1.let {
        println("ì´ë¦„: ${it.name}, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ${it.favorite}")
    }
    // ì´ë¦„: í˜í¼, ì¢‹ì•„í•˜ëŠ”ê²ƒ: Dr pepper

    val person2 = person1.let {
        it.name = "ì¤€í›„"
        it.favorite = "ë‹¥í„°í˜í¼"
        "ì´ë¦„: ${it.name}, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ${it.favorite}"    // (T) -> R ë¶€ë¶„ì—ì„œì˜ ë°˜í™˜ê°’
    }
    println(person2)
    // ì´ë¦„: ì¤€í›„, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ë‹¥í„°í˜í¼
}
```
ì•ˆë“œë¡œì´ë“œì—ì„œ letì€ `T?.let{ }`(safe call)ì˜ í˜•íƒœë¡œ let ë¸”ë¡ì•ˆì— __not-null__ ë§Œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆì–´ null ì²´í¬ ì‹œì— ìœ ìš©í•˜ê²Œ ì“°ì¸ë‹¤. 

```kotlin
val response = // ì„œë²„ë¡œë¶€í„° ë°ì´í„° ìš”ì²­
        if (response.isSuccessful) {
            // body()ê°€ nullì´ ì•„ë‹ˆë¼ë©´ ì‹¤í–‰
            // it -> resultë¼ëŠ” ì´ë¦„ì˜ ì¸ìë¡œ ë°”ê¾¸ì–´ ì‚¬ìš©ê°€ëŠ¥
            response.body()?.let { result ->
                return // Something
            }
        }
```

## also
> fun <T> T.also(block: (T) -> Unit): T

`also`ëŠ” ì–¸ë“¯ë³´ë©´ `let`ê³¼ ì—­í• ì´ ê±°ì˜ ë™ì¼í•´ ë³´ì¸ë‹¤. í•˜ì§€ë§Œ ë°˜í™˜ê°’ì„ ë³´ë©´ __T__ ë¼ëŠ” ê²ƒìœ¼ë¡œ ì¡°ê¸ˆ ë‹¤ë¥¸ë°, __letì€ ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ˜í–‰ëœ ì½”ë“œ ë¸”ë¡ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜__ í•˜ê³  __alsoëŠ” ë¸”ë¡ ì•ˆì˜ ì½”ë“œì™€ ìƒê´€ì—†ì´ Tì¸ ê°ì²´ë¥¼ ë°˜í™˜__ í•œë‹¤.

```kotlin
val person2 = person.let {
    it.name = "ì¤€í›„"
    it.favorite = "ë‹¥í„°í˜í¼"
    "ì´ë¦„: ${it.name}, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ${it.favorite}"    // (T) -> R ë¶€ë¶„ì—ì„œì˜ ë°˜í™˜ê°’
}
println(person2)
// ì´ë¦„: ì¤€í›„, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ë‹¥í„°í˜í¼

val person3 = person.also {
    it.name = "ì¤€í›„"
    it.favorite = "ë‹¥í„°í˜í¼"
    "ì´ë¦„: ${it.name}, ì¢‹ì•„í•˜ëŠ”ê²ƒ: ${it.favorite}"    // ë¬´ì‹œ
}
println(person3)
// Person(name=ì¤€í›„, favorite=ë‹¥í„°í˜í¼) -> Tì¸ person ê°ì²´ ë°˜í™˜
```

## with
> fun <T, R> with(receiver: T, block: T.() -> R): R

`with`ëŠ” ë‹¤ë¥¸ ìŠ¤ì½”í”„ í•¨ìˆ˜ë“¤ê³¼ ë‹¤ë¥´ê²Œ __ì¼ë°˜ í•¨ìˆ˜__ ì´ë‹¤. ë”°ë¼ì„œ __ê°ì²´ receiverë¥¼ ì§ì ‘ ì…ë ¥__ ë°›ê³  `receiver`ë¡œ ê°ì²´ë¥¼ ì…ë ¥ ë°›ìœ¼ë©´ , `this` í‚¤ì›Œë“œ ì—†ì´ __ê°ì²´ì˜ ì†ì„±__ ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

`with`ëŠ” `not-null`ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ìš©í•˜ê³ , ë¸”ë¡ì˜ ë°˜í™˜ê°’ì´ í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•œë‹¤.

ì£¼ë¡œ `with`ëŠ” __ê°ì²´ì˜ í•¨ìˆ˜ë‚˜ ì†ì„±ì„ ì—¬ëŸ¬ê°œ í˜¸ì¶œí•  ë•Œ ê·¸ë£¹í™”__ í•˜ëŠ” ìš©ë„ë¡œ ë§ì´ í™œìš©í•œë‹¤.

```kotlin
binding.userId.text~
binding.userpwd.text~

// ì£¼ë¡œ ì•ˆë“œë¡œì´ë“œì—ì„œ view bindingì„ ì‚¬ìš©í• ë•Œ withì‚¬ìš©
with(binding) {
    userId.text ~~
    userpwd.text ~
}
```

## run
`run`ì€ ë‘ ê°€ì§€ í˜•íƒœë¡œ ì„ ì–¸ì´ ë˜ì–´ ìˆëŠ”ë°, ì²« ë²ˆì§¸ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
> fun <T, R> T.run(block: T.() -> R): R

`run`ì€ withì™€ ìœ ì‚¬í•˜ì§€ë§Œ Tì˜ í™•ì¥í•¨ìˆ˜ë¼ëŠ” ì ì—ì„œ ì°¨ì´ê°€ ìˆë‹¤. ë˜í•œ í™•ì¥í•¨ìˆ˜ ì´ê¸°ë•Œë¬¸ì— `T?.`(safe call)ì„ ì‚¬ìš©í•˜ë©´ __null ê°ì²´ê°€ ë“¤ì–´ì™€ë„ not-nullì„ ì²´í¬í•˜ê³  ì‹¤í–‰__ ì´ ê°€ëŠ¥í•˜ë‹¤. 

`run`ì€ __ì–´ë–¤ ê°’ì„ ê³„ì‚°í•  í•„ìš”__ ê°€ ìˆê±°ë‚˜, __ì—¬ëŸ¬ ê°œì˜ ì§€ì—­ë³€ìˆ˜ ë²”ìœ„ë¥¼ ì œí•œ__ í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤.

```kotlin
val favorite = person.run {
    // personì„ ìˆ˜ì‹ ê°ì²´ë¡œ ë³€í™˜í•˜ì—¬ favorite ê°’ì„ ì‚¬ìš©
    println("ê°€ì¥ì¢‹ì•„í•˜ëŠ”ê²ƒ: $favorite")
    favorite.plus(" ì¡´ë§›íƒ±!!")     // runì€ ë§ˆì§€ë§‰ ì‹¤í–‰ë¬¸ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜
}
println("ê°€ì¥ì¢‹ì•„í•˜ëŠ”ê²ƒ: $favorite")
// ê°€ì¥ì¢‹ì•„í•˜ëŠ”ê²ƒ: ë‹¥í„°í˜í¼
// ê°€ì¥ì¢‹ì•„í•˜ëŠ”ê²ƒ: ë‹¥í„°í˜í¼ ì¡´ë§›íƒ±!!
}
```
ë‘ ë²ˆì§¸ ì„ ì–¸ ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ë‹¤.
> fun <R> run(block: () -> R): R

ì´ `run`ì€ __í™•ì¥í•¨ìˆ˜ë„ ì•„ë‹ˆê³ , ë¸”ë¡ì— ëŒ€í•œ ì…ë ¥ê°’ë„ ì—†ë‹¤.__ ë”°ë¼ì„œ ê°ì²´ë¥¼ ì „ë‹¬ ë°›ê³  ì†ì„±ì„ ì´ìš©í• ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ê°€ ì•„ë‹ˆê³ , __ì–´ë–¤ ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ëª…ë ¹ë¬¸ë“¤ì„ í•˜ë‚˜ë¡œ ë¬¶ìŒìœ¼ë¡œì¨ ê°€ë…ì„±ì„ ë†’ì´ëŠ” ì—­í• ì„ í•œë‹¤.__

```kotlin
val person = run {
    val name = "ppeper"
    val favorite = "ë‹¥í„°í˜í¼"
    Person(name, favorite) // Return
}
```
ì´ë ‡ê²Œ ì‚¬ìš©í•œë‹¤ë©´ Person() ê°ì²´ ê°€ `person`ì— ë‹´ê¸°ê²Œ ëœë‹¤.

## apply
> fun <T> T.apply(block: T.() -> Unit): T

`apply`ëŠ” Tì˜ í™•ì¥í•¨ìˆ˜ë¡œ runê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ë°˜í™˜ê°’ì„ ë°›ì§€ì•Šê³  ê°ì²´ Të¥¼ ë°˜í™˜í•œë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤. ë”°ë¼ì„œ applyëŠ” ì´ë¦„ì—ì„œ ëŠë‚„ìˆ˜ ìˆë“¯ì´, __ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  íŠ¹ì • ë³€ìˆ˜ì— í• ë‹¹í•˜ê¸° ì „__ ì— __ì´ˆê¸°í™” ì‘ì—…__ ì„ í•˜ê±°ë‚˜ ë³€ê²½í• ë•Œ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ ì•ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ `apply` ìŠ¤ì½”í”„ ë‚´ì— ëª¨ë“  ëª…ë ¹ì„ ìˆ˜í–‰í•˜ì—¬ ì ìš©ëœ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ (T) ë°˜í™˜ í•œë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤.

```kotlin
val person = Person("", "")
person.apply {
    name = "ppeper"
    favorite = "ë‹¥í„°í˜í¼"
}
println("$person")
// Person(name=ppeper, favorite=ë‹¥í„°í˜í¼)
``` 
- - -

# References
- [https://blog.yena.io/studynote/2020/04/15/Kotlin-Scope-Functions.html](https://blog.yena.io/studynote/2020/04/15/Kotlin-Scope-Functions.html)